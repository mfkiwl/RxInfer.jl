<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Assessing People’s Skills · RxInfer.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://biaslab.github.io/RxInfer.jl/examples/Assessing People Skills/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/theme.css" rel="stylesheet" type="text/css"/><link href="../../assets/header.css" rel="stylesheet" type="text/css"/><script src="../../assets/header.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="RxInfer.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="RxInfer.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RxInfer.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../manuals/getting-started/">Getting started</a></li><li><a class="tocitem" href="../../manuals/model-specification/">Model specification</a></li><li><a class="tocitem" href="../../manuals/constraints-specification/">Constraints specification</a></li><li><a class="tocitem" href="../../manuals/meta-specification/">Meta specification</a></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Inference specification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manuals/inference/overview/">Overview</a></li><li><a class="tocitem" href="../../manuals/inference/inference/">Static dataset</a></li><li><a class="tocitem" href="../../manuals/inference/rxinference/">Real-time dataset / reactive inference</a></li><li><a class="tocitem" href="../../manuals/inference/postprocess/">Inference results postprocessing</a></li><li><a class="tocitem" href="../../manuals/inference/manual/">Manual inference specification</a></li></ul></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../library/functional-forms/">Built-in functional form constraints</a></li><li><a class="tocitem" href="../../library/model-specification/">Model specification</a></li><li><a class="tocitem" href="../../library/bethe-free-energy/">Bethe Free Energy</a></li><li><a class="tocitem" href="../../library/exported-methods/">Exported methods</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../Coin Toss Model/">Coin toss model (Beta-Bernoulli)</a></li><li><a class="tocitem" href="../Linear Regression/">Bayesian Linear Regression</a></li><li><a class="tocitem" href="../Active Inference Mountain car/">Active Inference Mountain car</a></li><li class="is-active"><a class="tocitem" href>Assessing People’s Skills</a></li><li><a class="tocitem" href="../Gaussian Linear Dynamical System/">Gaussian Linear Dynamical System</a></li><li><a class="tocitem" href="../Hidden Markov Model/">Ensemble Learning of a Hidden Markov Model</a></li><li><a class="tocitem" href="../Autoregressive Model/">Autoregressive Model</a></li><li><a class="tocitem" href="../Hierarchical Gaussian Filter/">Hierarchical Gaussian Filter</a></li><li><a class="tocitem" href="../Bayesian ARMA/">Bayesian ARMA model</a></li><li><a class="tocitem" href="../Infinite Data Stream/">Infinite Data Stream</a></li><li><a class="tocitem" href="../Identification Problem/">System Identification Problem</a></li><li><a class="tocitem" href="../Gaussian Mixture Univariate/">Univariate Gaussian Mixture Model</a></li><li><a class="tocitem" href="../Gaussian Mixtures Multivariate/">Multivariate Gaussian Mixture Model</a></li><li><a class="tocitem" href="../Gamma Mixture/">Gamma Mixture Model</a></li><li><a class="tocitem" href="../Universal Mixtures/">Universal Mixtures</a></li><li><a class="tocitem" href="../Global Parameter Optimisation/">Global Parameter Optimisation</a></li><li><a class="tocitem" href="../Invertible Neural Network Tutorial/">Invertible neural networks: a tutorial</a></li><li><a class="tocitem" href="../Conjugate-Computational Variational Message Passing/">Conjugate-Computational Variational Message Passing (CVI)</a></li><li><a class="tocitem" href="../GPRegression by SSM/">Solve GP regression by SDE</a></li><li><a class="tocitem" href="../Nonlinear Noisy Pendulum/">Nonlinear Smoothing: Noisy Pendulum</a></li><li><a class="tocitem" href="../Nonlinear Rabbit Population/">Nonlinear Smoothing: Rabbit Population</a></li><li><a class="tocitem" href="../Nonlinear Virus Spread/">Nonlinear Virus Spread</a></li><li><a class="tocitem" href="../Nonlinear Sensor Fusion/">Nonlinear Sensor Fusion</a></li><li><a class="tocitem" href="../Kalman filter with LSTM network driven dynamic/">Kalman filter with LSTM network driven dynamic</a></li><li><a class="tocitem" href="../Handling Missing Data/">Handling Missing Data</a></li><li><a class="tocitem" href="../Custom nonlinear node/">Custom Nonlinear Node</a></li><li><a class="tocitem" href="../Probit Model (EP)/">Probit Model (EP)</a></li><li><a class="tocitem" href="../RTS vs BIFM Smoothing/">RTS vs BIFM Smoothing</a></li><li><a class="tocitem" href="../Advanced Tutorial/">Advanced Tutorial</a></li></ul></li><li><span class="tocitem">Contributing</span><ul><li><a class="tocitem" href="../../contributing/overview/">Overview</a></li><li><a class="tocitem" href="../../contributing/new-example/">Adding a new example</a></li><li><a class="tocitem" href="../../contributing/new-release/">Publishing a new release</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Assessing People’s Skills</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Assessing People’s Skills</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/biaslab/RxInfer.jl/blob/main/docs/src/examples/Assessing People Skills.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>This example has been auto-generated from the <a href="https://github.com/biaslab/RxInfer.jl/tree/main/examples"><code>examples/</code></a> folder at GitHub repository.</p><h1 id="examples-assessing-people’s-skills"><a class="docs-heading-anchor" href="#examples-assessing-people’s-skills">Assessing People’s Skills</a><a id="examples-assessing-people’s-skills-1"></a><a class="docs-heading-anchor-permalink" href="#examples-assessing-people’s-skills" title="Permalink"></a></h1><pre><code class="language-julia hljs"># Activate local environment, see `Project.toml`
import Pkg; Pkg.activate(&quot;.&quot;); Pkg.instantiate();</code></pre><p>This demo demonstrates the capabilities of ReactiveMP.jl to perform inference in the models composed of Bernoulli random variables.</p><p>The demo is inspired by the example from Chapter 2 of Bishop&#39;s Model-Based Machine Learning book. We are going to perform an exact inference to assess the skills of a student given the results of the test.</p><p>Let us assume that our imaginary test is composed of three questions, and each of these questions is associated with test results <span>$r$</span>, where <span>$\{r \in \mathbb{R}, 0 &lt; r &lt; 1\}$</span></p><p>The result of the first question will solely depend on the student&#39;s attendance. For example, if the student attends the lectures, he will most certainly answer the first question. The result of the second question will depend on a specific skill <span>$s_2$</span>. However, if the student has attended the lectures, he would still have a good chance of answering the second question. We will model this relationship through disjunction or logical <span>$OR$</span>. The third question is more difficult to answer, i.e., the student needs to have a particular skill <span>$s_3$</span> <strong>and</strong> he must have good attendance or must have a <span>$s_3$</span> Hence, to model this relationship between skills and the third question, we will use conjunction or logical <span>$AND$</span>.</p><p>For the sake of the example, we will replace attendance with laziness. The convention is that if a person is not lazy, he attends lectures. This way, the first question can be answered if the student is not lazy. We will use the <span>$NOT$</span> function to represent this relationship.</p><p>Let us define the generative model: <span>$p(l, s_2, s_3, r_1, r_2, r_3)=p(l)p(s_2)p(s_3)p(r_1|f_1(l))p(r_2|f_2(l, s_2))p(r_3|f_3(l, s_2, s_3))$</span></p><p>The factors <span>$p(l), p(s_2), p(s_3)$</span> represent Bernoulli prior distributions. </p><p class="math-container">\[f_1(l) = NOT(l)\]</p><p>where <span>$NOT(X) \triangleq \overline{X}$</span>, </p><p class="math-container">\[f_2(l, s_2) = OR(NOT(l), s_2)\]</p><p>where <span>$OR(X, Y) \triangleq X \vee Y$</span>, </p><p class="math-container">\[f_3(l, s_2, s_3) = AND(OR(NOT(l), s_2), s_3)\]</p><p>where <span>$AND(X, Y) \triangleq X \land Y$</span></p><p>An attentive reader may notice that <span>$f_2(l, s_2)$</span> can be rewritten as <span>$IMPLY(l, s_2)$</span>, i.e., <span>$l\implies s_2$</span> </p><p>Similar to the example from the Model-Based Machine Learning book, our observations are noisy. It means that the likelihood functions should map <span>$\{0, 1\}$</span> to a real value <span>$r \in (0, 1)$</span>, denoting the result of the test. We can associate <span>$r=0$</span> and <span>$r=1.0$</span> with <span>$0\%$</span> and <span>$100\%$</span> correctness of the test, respectively.</p><p>One way of specifying the likelihood is <span>$p(r_i|f) = \begin{cases} r_i &amp; \text{if }f_i = 1 \\
1-r_i &amp; \text{if }f_i=0 \end{cases}$</span> or <span>$p(r_i|f)=r_if_i+(1-r_i)(1-f_i)$</span></p><p>It can be shown that given the observation <span>$r_i$</span>, the backward message from the node <span>$p(r_i|f_i)$</span> will be a Bernoulli distribution with parameter <span>$r_i$</span>, i.e. <span>$\overleftarrow{\mu}({f_i})\propto\mathrm{Ber}(r_i)$</span>.  If we observe <span>$r_i=0.9$</span> it is more &quot;likely&quot; that the variable <span>$f_i=1$</span>.</p><p>Following Bishop, we will call this node function <strong>AddNoise</strong></p><pre><code class="language-julia hljs">using RxInfer, Random</code></pre><pre><code class="language-julia hljs"># Create AddNoise node
struct AddNoise end

@node AddNoise Stochastic [out, in]</code></pre><pre><code class="language-julia hljs"># Adding update rule for AddNoise node
@rule AddNoise(:in, Marginalisation) (q_out::PointMass,) = begin     
    return Bernoulli(mean(q_out))
end</code></pre><pre><code class="language-julia hljs"># GraphPPL.jl export `@model` macro for model specification
# It accepts a regular Julia function and builds an FFG under the hood
@model function skill_model()

    res = datavar(Float64, 3)

    laziness ~ Bernoulli(0.5)
    skill2 ~ Bernoulli(0.5)
    skill3 ~ Bernoulli(0.5)

    test2 ~ laziness -&gt; skill2
    test3 ~ test2 &amp;&amp; skill3
    
    res[1] ~ AddNoise(¬laziness)
    res[2] ~ AddNoise(test2)
    res[3] ~ AddNoise(test3)

end</code></pre><p>Let us assume that a student scoared <span>$70\%$</span> and <span>$95\%$</span> at first and second tests respectively. But got only <span>$30\%$</span> on the third one. </p><pre><code class="language-julia hljs">test_results = [0.7, 0.95, 0.3]

inference_result = inference(
    model = skill_model(),
    data  = (res = test_results, )
)</code></pre><pre><code class="nohighlight hljs">Inference results:
  Posteriors       | available for (skill3, test2, test3, skill2, laziness)</code></pre><pre><code class="language-julia hljs">inference_result.posteriors[:laziness]</code></pre><pre><code class="nohighlight hljs">Bernoulli{Float64}(p=0.18704156479217607)</code></pre><pre><code class="language-julia hljs">inference_result.posteriors[:skill2]</code></pre><pre><code class="nohighlight hljs">Bernoulli{Float64}(p=0.5806845965770171)</code></pre><pre><code class="language-julia hljs">inference_result.posteriors[:skill3]</code></pre><pre><code class="nohighlight hljs">Bernoulli{Float64}(p=0.3025672371638141)</code></pre><p>The results make sense. On the one hand, the student answered the first question correctly, which immediately gives us reason to believe that he is not lazy. He answered the second question pretty well, but this does not mean that the student had the skills to answer this question (attendance,i.e., lack of laziness, could help). To answer the third question, it was necessary to answer the second and have additional skills (#3). Unfortunately, the student&#39;s answer was weak, so our confidence about skill #3 was shattered.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Active Inference Mountain car/">« Active Inference Mountain car</a><a class="docs-footer-nextpage" href="../Gaussian Linear Dynamical System/">Gaussian Linear Dynamical System »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 16 January 2023 08:32">Monday 16 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
